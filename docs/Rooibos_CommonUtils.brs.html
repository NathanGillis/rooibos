<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Rooibos_CommonUtils.brs - Documentation</title>

    <script src="scripts/prettify/prettify.js"></script>
    <script src="scripts/prettify/lang-css.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="https://code.ionicframework.com/ionicons/2.0.1/css/ionicons.min.css">
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>
<body>

<input type="checkbox" id="nav-trigger" class="nav-trigger" />
<label for="nav-trigger" class="navicon-button x">
  <div class="navicon"></div>
</label>

<label for="nav-trigger" class="overlay"></label>

<nav>
    <li class="nav-link nav-home-link"><a href="index.html">Home</a></li><li class="nav-heading">Modules</li><li class="nav-heading"><span class="nav-item-type type-module">M</span><span class="nav-item-name"><a href="module-BaseTestSuite.html">BaseTestSuite</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-BaseTestSuite.html#AddTest">AddTest</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-BaseTestSuite.html#AssertAAContainsSubset">AssertAAContainsSubset</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-BaseTestSuite.html#AssertAAHasKey">AssertAAHasKey</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-BaseTestSuite.html#AssertAAHasKeys">AssertAAHasKeys</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-BaseTestSuite.html#AssertAANotHasKey">AssertAANotHasKey</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-BaseTestSuite.html#AssertAANotHasKeys">AssertAANotHasKeys</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-BaseTestSuite.html#AssertArrayContains">AssertArrayContains</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-BaseTestSuite.html#AssertArrayContainsAAs">AssertArrayContainsAAs</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-BaseTestSuite.html#AssertArrayContainsOnlyValuesOfType">AssertArrayContainsOnlyValuesOfType</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-BaseTestSuite.html#AssertArrayContainsSubset">AssertArrayContainsSubset</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-BaseTestSuite.html#AssertArrayCount">AssertArrayCount</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-BaseTestSuite.html#AssertArrayNotContains">AssertArrayNotContains</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-BaseTestSuite.html#AssertArrayNotContainsSubset">AssertArrayNotContainsSubset</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-BaseTestSuite.html#AssertArrayNotCount">AssertArrayNotCount</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-BaseTestSuite.html#AssertEmpty">AssertEmpty</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-BaseTestSuite.html#AssertEqual">AssertEqual</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-BaseTestSuite.html#AssertFalse">AssertFalse</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-BaseTestSuite.html#AssertInvalid">AssertInvalid</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-BaseTestSuite.html#AssertLike">AssertLike</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-BaseTestSuite.html#AssertMocks">AssertMocks</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-BaseTestSuite.html#AssertNodeContainsFields">AssertNodeContainsFields</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-BaseTestSuite.html#AssertNodeContainsOnly">AssertNodeContainsOnly</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-BaseTestSuite.html#AssertNodeCount">AssertNodeCount</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-BaseTestSuite.html#AssertNodeEmpty">AssertNodeEmpty</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-BaseTestSuite.html#AssertNodeEmpty">AssertNodeEmpty</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-BaseTestSuite.html#AssertNodeNotContains">AssertNodeNotContains</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-BaseTestSuite.html#AssertNodeNotContainsFields">AssertNodeNotContainsFields</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-BaseTestSuite.html#AssertNodeNotCount">AssertNodeNotCount</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-BaseTestSuite.html#AssertNodeNotEmpty">AssertNodeNotEmpty</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-BaseTestSuite.html#AssertNotEmpty">AssertNotEmpty</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-BaseTestSuite.html#AssertNotEqual">AssertNotEqual</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-BaseTestSuite.html#AssertNotInvalid">AssertNotInvalid</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-BaseTestSuite.html#AssertSubType">AssertSubType</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-BaseTestSuite.html#AssertTrue">AssertTrue</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-BaseTestSuite.html#AssertType">AssertType</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-BaseTestSuite.html#CleanMocks">CleanMocks</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-BaseTestSuite.html#CleanStubs">CleanStubs</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-BaseTestSuite.html#CreateFake">CreateFake</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-BaseTestSuite.html#CreateTest">CreateTest</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-BaseTestSuite.html#EqArray">EqArray</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-BaseTestSuite.html#EqAssocArray">EqAssocArray</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-BaseTestSuite.html#EqValues">EqValues</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-BaseTestSuite.html#Expect">Expect</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-BaseTestSuite.html#ExpectNone">ExpectNone</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-BaseTestSuite.html#ExpectOnce">ExpectOnce</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-BaseTestSuite.html#ExpectOnceOrNone">ExpectOnceOrNone</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-BaseTestSuite.html#Fail">Fail</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-BaseTestSuite.html#g">g</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-BaseTestSuite.html#Mock">Mock</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-BaseTestSuite.html#Stub">Stub</a></span></li><li class="nav-heading"><span class="nav-item-type type-module">M</span><span class="nav-item-name"><a href="module-CommonUtils.html">CommonUtils</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-CommonUtils.html#.ArrayContains">ArrayContains</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-CommonUtils.html#.AsArray">AsArray</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-CommonUtils.html#.AsBoolean">AsBoolean</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-CommonUtils.html#.AsDouble">AsDouble</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-CommonUtils.html#.AsFloat">AsFloat</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-CommonUtils.html#.AsInteger">AsInteger</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-CommonUtils.html#.AsLongInteger">AsLongInteger</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-CommonUtils.html#.AsString">AsString</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-CommonUtils.html#.FindElementIndexInArray">FindElementIndexInArray</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-CommonUtils.html#.FindElementIndexInNode">FindElementIndexInNode</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-CommonUtils.html#.IsArray">IsArray</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-CommonUtils.html#.IsAssociativeArray">IsAssociativeArray</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-CommonUtils.html#.IsBoolean">IsBoolean</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-CommonUtils.html#.IsDateTime">IsDateTime</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-CommonUtils.html#.IsDouble">IsDouble</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-CommonUtils.html#.IsFloat">IsFloat</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-CommonUtils.html#.IsFunction">IsFunction</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-CommonUtils.html#.IsInteger">IsInteger</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-CommonUtils.html#.IsList">IsList</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-CommonUtils.html#.IsLongInteger">IsLongInteger</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-CommonUtils.html#.IsNotEmptyString">IsNotEmptyString</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-CommonUtils.html#.IsNullOrEmpty">IsNullOrEmpty</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-CommonUtils.html#.IsNumber">IsNumber</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-CommonUtils.html#.IsSGNode">IsSGNode</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-CommonUtils.html#.IsString">IsString</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-CommonUtils.html#.IsValid">IsValid</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-CommonUtils.html#.RBS_CMN_GetFunction">RBS_CMN_GetFunction</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-CommonUtils.html#.RBS_CMN_GetFunctionBruteforce">RBS_CMN_GetFunctionBruteforce</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-CommonUtils.html#.ValidStr">ValidStr</a></span></li><li class="nav-heading"><span class="nav-item-type type-module">M</span><span class="nav-item-name"><a href="module-ItemGenerator.html">ItemGenerator</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-ItemGenerator.html#GetArray">GetArray</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-ItemGenerator.html#GetAssocArray">GetAssocArray</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-ItemGenerator.html#GetBoolean">GetBoolean</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-ItemGenerator.html#GetFloat">GetFloat</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-ItemGenerator.html#GetInteger">GetInteger</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-ItemGenerator.html#GetItem">GetItem</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-ItemGenerator.html#GetSimpleType">GetSimpleType</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-ItemGenerator.html#GetString">GetString</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-ItemGenerator.html#ItemGenerator">ItemGenerator</a></span></li><li class="nav-heading"><span class="nav-item-type type-module">M</span><span class="nav-item-name"><a href="module-rooibosh.html">rooibosh</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-rooibosh.html#.Rooibos__Init">Rooibos__Init</a></span></li><li class="nav-heading"><span class="nav-item-type type-module">M</span><span class="nav-item-name"><a href="module-TestRunner.html">TestRunner</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-TestRunner.html#.RBS_TR_TestRunner">RBS_TR_TestRunner</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-TestRunner.html#Rooibos_CreateTestNode">Rooibos_CreateTestNode</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-TestRunner.html#Rooibos_RunNodeTests">Rooibos_RunNodeTests</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-TestRunner.html#Run">Run</a></span></li>
</nav>

<div id="main">
    
    <h1 class="page-title">Rooibos_CommonUtils.brs</h1>
    

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>' /**
'  * @module CommonUtils
'  */
' /******************
' Common utility functions
' /******************

' /**
'  * @name IsXmlElement
'  * @function
'  * @description check if value contains XMLElement interface
'  * @memberof module:CommonUtils
'  * @param {Dynamic} value - value to check
'  * @returns {Boolean} - true if value contains XMLElement interface, else return false
'  */
function RBS_CMN_IsXmlElement(value ) as boolean
  return RBS_CMN_IsValid(value) and GetInterface(value, "ifXMLElement") &lt;> invalid
end function

' /**
'  * @name IsFunction
'  * @function
'  * @description check if value contains Function interface
'  * @memberof module:CommonUtils
'  * @param {Dynamic} value - value to check
'  * @returns {Boolean} - true if value contains Function interface, else return false
'  */
function RBS_CMN_IsFunction(value ) as boolean
  return RBS_CMN_IsValid(value) and GetInterface(value, "ifFunction") &lt;> invalid
end function


' /**
'  * @name RBS_CMN_GetFunction
'  * @function
'  * @description looks up the function by name, for the function map
'  * @memberof module:CommonUtils
'  * @param {filename} string - name of the file where the function was found
'  * @param {String} functionName - name of the function to locate
'  * @returns {Function} - function pointer or invalid
'  */
function RBS_CMN_GetFunction(filename, functionName) as object
  if (not RBS_CMN_IsNotEmptyString(functionName)) then return invalid
  if (not RBS_CMN_IsNotEmptyString(filename)) then return invalid
  mapFunction = RBSFM_getFunctionsForFile(filename)
  if mapFunction &lt;> invalid
    map = mapFunction()
    if (type(map) ="roAssociativeArray")
      functionPointer = map[functionName]
      return functionPointer
    else
      return invalid
    end if
  end if
  return invalid

end function

' /**
'  * @name RBS_CMN_GetFunctionBruteforce
'  * @function
'  * @description looks up the function by name, from any function map
'  *            in future, functions retrieved in this way are stored in the special RBS_INTERNAL file map
'  * @memberof module:CommonUtils
'  * @param {filename} string - name of the file where the function was found
'  * @param {String} functionName - name of the function to locate
'  * @returns {Function} - function pointer or invalid
'  */
function RBS_CMN_GetFunctionBruteForce(functionName) as object
  if (not RBS_CMN_IsNotEmptyString(functionName)) then return invalid
  ' func = RBS_CMN_GetFunction("RBS_INTERNAL", functionName)
  ' if func &lt;> invalid
  '   return func
  ' end if

  filenames = RBSFM_getFilenames()
  for i = 0 to filenames.count() - 1
    filename = filenames[i]
    mapFunction = RBSFM_getFunctionsForFile(filename)
    if mapFunction &lt;> invalid
      map = mapFunction()
      if (type(map) ="roAssociativeArray")
        functionPointer = map[functionName]
        if functionPointer &lt;> invalid
          return functionPointer
        end if
      end if
    end if
  end for
  return invalid

end function

' /**
'  * @name IsBoolean
'  * @function
'  * @description check if value contains Boolean interface
'  * @memberof module:CommonUtils
'  * @param {Dynamic} value - value to check
'  * @returns {Boolean} - true if value contains Boolean interface, else return false
'  */
function RBS_CMN_IsBoolean(value ) as boolean
  return RBS_CMN_IsValid(value) and GetInterface(value, "ifBoolean") &lt;> invalid
end function

' /**
'  * @name IsInteger
'  * @function
'  * @description check if value type equals Integer
'  * @memberof module:CommonUtils
'  * @param {Dynamic} value - value to check
'  * @returns {Boolean} - true if value type equals Integer, else return false
'  */
function RBS_CMN_IsInteger(value ) as boolean
  return RBS_CMN_IsValid(value) and GetInterface(value, "ifInt") &lt;> invalid and (Type(value) = "roInt" or Type(value) = "roInteger" or Type(value) = "Integer")
end function

' /**
'  * @name IsFloat
'  * @function
'  * @description check if value contains Float interface
'  * @memberof module:CommonUtils
'  * @param {Dynamic} value - value to check
'  * @returns {Boolean} - true if value contains Float interface, else return false
'  */
function RBS_CMN_IsFloat(value ) as boolean
  return RBS_CMN_IsValid(value) and GetInterface(value, "ifFloat") &lt;> invalid
end function

' /**
'  * @name IsDouble
'  * @function
'  * @description check if value contains Double interface
'  * @memberof module:CommonUtils
'  * @param {Dynamic} value - value to check
'  * @returns {Boolean} - true if value contains Double interface, else return false
'  */
function RBS_CMN_IsDouble(value ) as boolean
  return RBS_CMN_IsValid(value) and GetInterface(value, "ifDouble") &lt;> invalid
end function

' /**
'  * @name IsLongInteger
'  * @function
'  * @description check if value contains LongInteger interface
'  * @memberof module:CommonUtils
'  * @param {Dynamic} value - value to check
'  * @returns {Boolean} - true if value contains LongInteger interface, else return false
'  */
function RBS_CMN_IsLongInteger(value ) as boolean
  return RBS_CMN_IsValid(value) and GetInterface(value, "ifLongInt") &lt;> invalid
end function

' /**
'  * @name IsNumber
'  * @function
'  * @description check if value contains LongInteger or Integer or Double or Float interface
'  * @memberof module:CommonUtils
'  * @param {Dynamic} value - value to check
'  * @returns {Boolean} - true if value is number, else return false
'  */
function RBS_CMN_IsNumber(value ) as boolean
  return RBS_CMN_IsLongInteger(value) or RBS_CMN_IsDouble(value) or RBS_CMN_IsInteger(value) or RBS_CMN_IsFloat(value)
end function

' /**
'  * @name IsList
'  * @function
'  * @description check if value contains List interface
'  * @memberof module:CommonUtils
'  * @param {Dynamic} value - value to check
'  * @returns {Boolean} - true if value contains List interface, else return false
'  */
function RBS_CMN_IsList(value ) as boolean
  return RBS_CMN_IsValid(value) and GetInterface(value, "ifList") &lt;> invalid
end function

' /**
'  * @name IsArray
'  * @function
'  * @description check if value contains Array interface
'  * @memberof module:CommonUtils
'  * @param {Dynamic} value - value to check
'  * @returns {Boolean} - true if value contains Array interface, else return false
'  */
function RBS_CMN_IsArray(value ) as boolean
  return RBS_CMN_IsValid(value) and GetInterface(value, "ifArray") &lt;> invalid
end function

' /**
'  * @name IsAssociativeArray
'  * @function
'  * @description check if value contains AssociativeArray interface
'  * @memberof module:CommonUtils
'  * @param {Dynamic} value - value to check
'  * @returns {Boolean} - true if value contains AssociativeArray interface, else return false
'  */
function RBS_CMN_IsAssociativeArray(value ) as boolean
  return RBS_CMN_IsValid(value) and GetInterface(value, "ifAssociativeArray") &lt;> invalid
end function

' /**
'  * @name IsSGNode
'  * @function
'  * @description check if value contains SGNodeChildren interface
'  * @memberof module:CommonUtils
'  * @param {Dynamic} value - value to check
'  * @returns {Boolean} - true if value contains SGNodeChildren interface, else return false
'  */
function RBS_CMN_IsSGNode(value ) as boolean
  return RBS_CMN_IsValid(value) and GetInterface(value, "ifSGNodeChildren") &lt;> invalid
end function

' /**
'  * @name IsString
'  * @function
'  * @description check if value contains String interface
'  * @memberof module:CommonUtils
'  * @param {Dynamic} value - value to check
'  * @returns {Boolean} - true if value contains String interface, else return false
'  */
function RBS_CMN_IsString(value ) as boolean
  return RBS_CMN_IsValid(value) and GetInterface(value, "ifString") &lt;> invalid
end function

' /**
'  * @name IsNotEmptyString
'  * @function
'  * @description check if value contains String interface and length more 0
'  * @memberof module:CommonUtils
'  * @param {Dynamic} value - value to check
'  * @returns {Boolean} - true if value contains String interface and length more 0, else return false
'  */
function RBS_CMN_IsNotEmptyString(value ) as boolean
  return RBS_CMN_IsString(value) and len(value) > 0
end function

' /**
'  * @name IsDateTime
'  * @function
'  * @description check if value contains DateTime interface
'  * @memberof module:CommonUtils
'  * @param {Dynamic} value - value to check
'  * @returns {Boolean} - true if value contains DateTime interface, else return false
'  */
function RBS_CMN_IsDateTime(value ) as boolean
  return RBS_CMN_IsValid(value) and (GetInterface(value, "ifDateTime") &lt;> invalid or Type(value) = "roDateTime")
end function

' /**
'  * @name IsValid
'  * @function
'  * @description check if value initialized and not equal invalid
'  * @memberof module:CommonUtils
'  * @param {Dynamic} value - value to check
'  * @returns {Boolean} - true if value initialized and not equal invalid, else return false
'  */
function RBS_CMN_IsValid(value ) as boolean
  return not RBS_CMN_IsUndefined(value) and value &lt;> invalid
end function

function RBS_CMN_IsUndefined(value ) as boolean
  return type(value) = "" or Type(value) = "&lt;uninitialized>"
end function

' /**
'  * @name ValidStr
'  * @function
'  * @description return value if his contains String interface else return empty string
'  * @memberof module:CommonUtils
'  * @param {Dynamic} value - value to check
'  * @returns {String} - value if his contains String interface else return empty string
'  */
function RBS_CMN_ValidStr(obj ) as string
  if obj &lt;> invalid and GetInterface(obj, "ifString") &lt;> invalid
    return obj
  else
    return ""
  end if
end function

' /**
'  * @name AsString
'  * @function
'  * @description convert input to String if this possible, else return empty string
'  * @memberof module:CommonUtils
'  * @param {Dynamic} input - value to check
'  * @returns {String} - converted string
'  */
function RBS_CMN_AsString(input ) as string
  if RBS_CMN_IsValid(input) = false
    return ""
  else if RBS_CMN_IsString(input)
    return input
  else if RBS_CMN_IsInteger(input) or RBS_CMN_IsLongInteger(input) or RBS_CMN_IsBoolean(input)
    return input.ToStr()
  else if RBS_CMN_IsFloat(input) or RBS_CMN_IsDouble(input)
    return Str(input).Trim()
  else if type(input) = "roSGNode"
    return "Node(" + input.subType() +")"
  else if type(input) = "roAssociativeArray"
    isFirst = true
    text = "{"
    if (not isFirst)
      text += ","
      isFirst = false
    end if
    for each key in input
      text += key + ":" + RBS_CMN_AsString(input[key])
    end for
    text += "}"
    return text
  else
    return ""
  end if
end function

' /**
'  * @name AsInteger
'  * @function
'  * @description convert input to Integer if this possible, else return 0
'  * @memberof module:CommonUtils
'  * @param {Dynamic} input - value to check
'  * @returns {Integer} - converted Integer
'  */
function RBS_CMN_AsInteger(input ) as integer
  if RBS_CMN_IsValid(input) = false
    return 0
  else if RBS_CMN_IsString(input)
    return input.ToInt()
  else if RBS_CMN_IsInteger(input)
    return input
  else if RBS_CMN_IsFloat(input) or RBS_CMN_IsDouble(input) or RBS_CMN_IsLongInteger(input)
    return Int(input)
  else
    return 0
  end if
end function

' /**
'  * @name AsLongInteger
'  * @function
'  * @description convert input to LongInteger if this possible, else return 0
'  * @memberof module:CommonUtils
'  * @param {Dynamic} input - value to check
'  * @returns {Integer} - converted LongInteger
'  */
function RBS_CMN_AsLongInteger(input ) as longinteger
  if RBS_CMN_IsValid(input) = false
    return 0
  else if RBS_CMN_IsString(input)
    return RBS_CMN_AsInteger(input)
  else if RBS_CMN_IsLongInteger(input) or RBS_CMN_IsFloat(input) or RBS_CMN_IsDouble(input) or RBS_CMN_IsInteger(input)
    return input
  else
    return 0
  end if
end function

' /**
'  * @name AsFloat
'  * @function
'  * @description convert input to Float if this possible, else return 0.0
'  * @memberof module:CommonUtils
'  * @param {Dynamic} input - value to check
'  * @returns {Float} - converted Float
'  */
function RBS_CMN_AsFloat(input ) as float
  if RBS_CMN_IsValid(input) = false
    return 0.0
  else if RBS_CMN_IsString(input)
    return input.ToFloat()
  else if RBS_CMN_IsInteger(input)
    return (input / 1)
  else if RBS_CMN_IsFloat(input) or RBS_CMN_IsDouble(input) or RBS_CMN_IsLongInteger(input)
    return input
  else
    return 0.0
  end if
end function

' /**
'  * @name AsDouble
'  * @function
'  * @description convert input to Double if this possible, else return 0.0
'  * @memberof module:CommonUtils
'  * @param {Dynamic} input - value to check
'  * @returns {Float} - converted Double
'  */
function RBS_CMN_AsDouble(input ) as double
  if RBS_CMN_IsValid(input) = false
    return 0.0
  else if RBS_CMN_IsString(input)
    return RBS_CMN_AsFloat(input)
  else if RBS_CMN_IsInteger(input) or RBS_CMN_IsLongInteger(input) or RBS_CMN_IsFloat(input) or RBS_CMN_IsDouble(input)
    return input
  else
    return 0.0
  end if
end function

' /**
'  * @name AsBoolean
'  * @function
'  * @description convert input to Boolean if this possible, else return False
'  * @memberof module:CommonUtils
'  * @param {Dynamic} input - value to check
'  * @returns {Boolean} - converted boolean
'  */
function RBS_CMN_AsBoolean(input ) as boolean
  if RBS_CMN_IsValid(input) = false
    return false
  else if RBS_CMN_IsString(input)
    return LCase(input) = "true"
  else if RBS_CMN_IsInteger(input) or RBS_CMN_IsFloat(input)
    return input &lt;> 0
  else if RBS_CMN_IsBoolean(input)
    return input
  else
    return false
  end if
end function

' /**
'  * @name AsArray
'  * @function
'  * @description if type of value equals array return value, else return array with one element [value]
'  * @memberof module:CommonUtils
'  * @param {Dynamic} value - value to check
'  * @returns {Array} - converted array
'  */
function RBS_CMN_AsArray(value ) as object
  if RBS_CMN_IsValid(value)
    if not RBS_CMN_IsArray(value)
      return [value]
    else
      return value
    end if
  end if
  return []
end function

'=====================
' Strings
'=====================

' /**
'  * @name IsNullOrEmpty
'  * @function
'  * @description check if value is invalid or empty
'  * @memberof module:CommonUtils
'  * @param {Dynamic} value - value to check
'  * @returns {Boolean} - true if value is null or empty string, else return false
'  */
function RBS_CMN_IsNullOrEmpty(value ) as boolean
  if RBS_CMN_IsString(value)
    return Len(value) = 0
  else
    return not RBS_CMN_IsValid(value)
  end if
end function

'=====================
' Arrays
'=====================

' /**
'  * @name FindElementIndexInArray
'  * @function
'  * @description find an element index in array
'  * @memberof module:CommonUtils
'  * @param {Dynamic} array - array to search
'  * @param {Dynamic} value - value to check
'  * @param {Dynamic} compareAttribute - attribue to use for comparisons
'  * @param {Boolean} caseSensitive - indicates if comparisons are case sensitive
'  * @returns {Integer} - element index if array contains a value, else return -1
'  */
function RBS_CMN_FindElementIndexInArray(array , value , compareAttribute = invalid , caseSensitive = false ) as integer
  if RBS_CMN_IsArray(array)
    for i = 0 to RBS_CMN_AsArray(array).Count() - 1
      compareValue = array[i]

      if compareAttribute &lt;> invalid and RBS_CMN_IsAssociativeArray(compareValue)
        compareValue = compareValue.LookupCI(compareAttribute)
      end if

      if RBS_BTS_EqValues(compareValue, value)
        return i
      end if

      item = array[i]
    next
  end if
  return -1
end function

' /**
'  * @name ArrayContains
'  * @function
'  * @description check if array contains specified value
'  * @memberof module:CommonUtils
'  * @param {Dynamic} array - array to search in
'  * @param {Dynamic} value - value to check
'  * @param {Dynamic} compareAttribute - attribute to compare on
'  * @returns {Boolean} - true if array contains a value, else return false
'  */
function RBS_CMN_ArrayContains(array , value , compareAttribute = invalid ) as boolean
  return (RBS_CMN_FindElementIndexInArray(array, value, compareAttribute) > -1)
end function


'=====================
' NODES
'=====================

' /**
'  * @name FindElementIndexInNode
'  * @function
'  * @description find an element index in node
'  * @memberof module:CommonUtils
'  * @param {Dynamic} node - node to search in
'  * @param {Dynamic} value - child to search for
'  * @returns {Integer} - element index if node contains a value, else return -1
'  */
function RBS_CMN_FindElementIndexInNode(node , value ) as integer
  if type(node) = "roSGNode"
    for i = 0 to node.getChildCount() - 1
      compareValue = node.getChild(i)
      if type(compareValue) = "roSGNode" and compareValue.isSameNode(value)
        return i
      end if
    next
  end if
  return -1
end function

' /**
'  * @name NodeContains
'  * @description check if node contains specified child
'  * @memberof module:CommonUtils
'  * @param {Dynamic} node - the node to check on
'  * @param {Dynamic} value - child to look for
'  * @returns {Boolean} - true if node contains a value, else return false
'  */
function RBS_CMN_NodeContains(node , value ) as boolean
  return (RBS_CMN_FindElementIndexInNode(node, value) > -1)
end function
</code></pre>
        </article>
    </section>




</div>

<br class="clear">

<footer>
    Generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.5.5</a> on Thu Mar 21 2019 15:09:23 GMT-0500 (-05) using the Minami theme.
</footer>

<script>prettyPrint();</script>
<script src="scripts/linenumber.js"></script>
</body>
</html>
